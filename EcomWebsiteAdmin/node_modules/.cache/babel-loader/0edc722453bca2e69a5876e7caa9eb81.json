{"ast":null,"code":"var _jsxFileName = \"D:\\\\job\\\\ComputerShopNode-Plus\\\\ComputerShopAdmin\\\\src\\\\views\\\\app-views\\\\apps\\\\voucher\\\\EditVoucherModal.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { Modal, Form, Input, Spin, message, notification, DatePicker, Switch } from \"antd\"; // Import các thành phần cần thiết\nimport moment from \"moment\"; // Import moment để xử lý ngày\nimport { updateVoucher } from \"services/voucherService\"; // Import hàm gọi API\n\nconst EditVoucherModal = ({\n  visible,\n  voucherData,\n  onCancel,\n  refreshVouchers\n}) => {\n  const [form] = Form.useForm();\n  const [loading, setLoading] = useState(false); // Thêm state để quản lý loading\n\n  useEffect(() => {\n    if (voucherData) {\n      form.setFieldsValue({\n        code: voucherData.code,\n        discount: voucherData.discount,\n        expirationDate: moment(voucherData.expirationDate),\n        // Định dạng lại ngày\n        isUsed: voucherData.isUsed\n      });\n    }\n  }, [voucherData, form]);\n  const handleFinish = async values => {\n    setLoading(true); // Bắt đầu loading\n\n    // Định dạng expirationDate về dạng ISO string\n    const expirationDate = moment(values.expirationDate).toISOString();\n\n    // Tạo đối tượng voucher\n    const voucherUpdateData = {\n      code: values.code,\n      discount: values.discount,\n      expirationDate: expirationDate,\n      isUsed: values.isUsed\n    };\n\n    // Gọi API cập nhật voucher\n    try {\n      await updateVoucher(voucherData._id, voucherUpdateData);\n      message.success(\"Chỉnh sửa voucher thành công\");\n      refreshVouchers(); // Cập nhật danh sách voucher\n      form.resetFields(); // Reset các trường trong form\n      onCancel(); // Đóng modal\n    } catch (error) {\n      notification.error({\n        message: \"Chỉnh sửa voucher thất bại\",\n        description: \"Có lỗi xảy ra khi cập nhật voucher.\",\n        placement: \"topRight\" // Vị trí thông báo\n      });\n      console.error(\"Error updating voucher:\", error);\n    } finally {\n      setLoading(false); // Kết thúc loading\n    }\n  };\n  return /*#__PURE__*/React.createElement(Modal, {\n    visible: visible,\n    title: \"Ch\\u1EC9nh S\\u1EEDa Voucher\",\n    okText: \"L\\u01B0u\",\n    cancelText: \"H\\u1EE7y\",\n    onCancel: onCancel,\n    onOk: () => form.submit(),\n    getPopupContainer: trigger => trigger.parentNode // Đặt getPopupContainer\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    form: form,\n    layout: \"vertical\",\n    onFinish: handleFinish,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"code\",\n    label: \"M\\xE3 Voucher\",\n    rules: [{\n      required: true,\n      message: \"Vui lòng nhập mã voucher!\"\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"discount\",\n    label: \"Gi\\u1EA3m Gi\\xE1 (%)\",\n    rules: [{\n      required: true,\n      message: \"Vui lòng nhập giảm giá!\"\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    type: \"number\",\n    min: 0,\n    max: 100,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"expirationDate\",\n    label: \"Ng\\xE0y H\\u1EBFt H\\u1EA1n\",\n    rules: [{\n      required: true,\n      message: \"Vui lòng chọn ngày hết hạn!\"\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DatePicker, {\n    style: {\n      width: \"100%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    label: \"\\u0110\\xE3 S\\u1EED D\\u1EE5ng\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"isUsed\",\n    valuePropName: \"checked\",\n    noStyle: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  })))), loading && /*#__PURE__*/React.createElement(Spin, {\n    style: {\n      display: \"block\",\n      margin: \"20px auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 19\n    }\n  }), \" \");\n};\nexport default EditVoucherModal;","map":{"version":3,"names":["React","useEffect","useState","Modal","Form","Input","Spin","message","notification","DatePicker","Switch","moment","updateVoucher","EditVoucherModal","visible","voucherData","onCancel","refreshVouchers","form","useForm","loading","setLoading","setFieldsValue","code","discount","expirationDate","isUsed","handleFinish","values","toISOString","voucherUpdateData","_id","success","resetFields","error","description","placement","console","createElement","title","okText","cancelText","onOk","submit","getPopupContainer","trigger","parentNode","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","layout","onFinish","Item","name","label","rules","required","type","min","max","style","width","valuePropName","noStyle","display","margin"],"sources":["D:/job/ComputerShopNode-Plus/ComputerShopAdmin/src/views/app-views/apps/voucher/EditVoucherModal.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  Modal,\r\n  Form,\r\n  Input,\r\n  Spin,\r\n  message,\r\n  notification,\r\n  DatePicker,\r\n  Switch,\r\n} from \"antd\"; // Import các thành phần cần thiết\r\nimport moment from \"moment\"; // Import moment để xử lý ngày\r\nimport { updateVoucher } from \"services/voucherService\"; // Import hàm gọi API\r\n\r\nconst EditVoucherModal = ({\r\n  visible,\r\n  voucherData,\r\n  onCancel,\r\n  refreshVouchers,\r\n}) => {\r\n  const [form] = Form.useForm();\r\n  const [loading, setLoading] = useState(false); // Thêm state để quản lý loading\r\n\r\n  useEffect(() => {\r\n    if (voucherData) {\r\n      form.setFieldsValue({\r\n        code: voucherData.code,\r\n        discount: voucherData.discount,\r\n        expirationDate: moment(voucherData.expirationDate), // Định dạng lại ngày\r\n        isUsed: voucherData.isUsed,\r\n      });\r\n    }\r\n  }, [voucherData, form]);\r\n\r\n  const handleFinish = async (values) => {\r\n    setLoading(true); // Bắt đầu loading\r\n\r\n    // Định dạng expirationDate về dạng ISO string\r\n    const expirationDate = moment(values.expirationDate).toISOString();\r\n\r\n    // Tạo đối tượng voucher\r\n    const voucherUpdateData = {\r\n      code: values.code,\r\n      discount: values.discount,\r\n      expirationDate: expirationDate,\r\n      isUsed: values.isUsed,\r\n    };\r\n\r\n    // Gọi API cập nhật voucher\r\n    try {\r\n      await updateVoucher(voucherData._id, voucherUpdateData);\r\n      message.success(\"Chỉnh sửa voucher thành công\");\r\n      refreshVouchers(); // Cập nhật danh sách voucher\r\n      form.resetFields(); // Reset các trường trong form\r\n      onCancel(); // Đóng modal\r\n    } catch (error) {\r\n      notification.error({\r\n        message: \"Chỉnh sửa voucher thất bại\",\r\n        description: \"Có lỗi xảy ra khi cập nhật voucher.\",\r\n        placement: \"topRight\", // Vị trí thông báo\r\n      });\r\n      console.error(\"Error updating voucher:\", error);\r\n    } finally {\r\n      setLoading(false); // Kết thúc loading\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      title=\"Chỉnh Sửa Voucher\"\r\n      okText=\"Lưu\"\r\n      cancelText=\"Hủy\"\r\n      onCancel={onCancel}\r\n      onOk={() => form.submit()}\r\n      getPopupContainer={(trigger) => trigger.parentNode} // Đặt getPopupContainer\r\n    >\r\n      <Form form={form} layout=\"vertical\" onFinish={handleFinish}>\r\n        <Form.Item\r\n          name=\"code\"\r\n          label=\"Mã Voucher\"\r\n          rules={[{ required: true, message: \"Vui lòng nhập mã voucher!\" }]}\r\n        >\r\n          <Input />\r\n        </Form.Item>\r\n        <Form.Item\r\n          name=\"discount\"\r\n          label=\"Giảm Giá (%)\"\r\n          rules={[{ required: true, message: \"Vui lòng nhập giảm giá!\" }]}\r\n        >\r\n          <Input type=\"number\" min={0} max={100} />\r\n        </Form.Item>\r\n        <Form.Item\r\n          name=\"expirationDate\"\r\n          label=\"Ngày Hết Hạn\"\r\n          rules={[{ required: true, message: \"Vui lòng chọn ngày hết hạn!\" }]}\r\n        >\r\n          <DatePicker style={{ width: \"100%\" }} />\r\n        </Form.Item>\r\n        <Form.Item label=\"Đã Sử Dụng\">\r\n          <Form.Item name=\"isUsed\" valuePropName=\"checked\" noStyle>\r\n            <Switch />\r\n          </Form.Item>\r\n        </Form.Item>\r\n      </Form>\r\n      {loading && <Spin style={{ display: \"block\", margin: \"20px auto\" }} />}{\" \"}\r\n      {/* Thêm spinner */}\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default EditVoucherModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}